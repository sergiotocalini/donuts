{% extends "base.html" %}
{% block title %}History{% endblock %}

{% block js%}
<script>
$( document ).ready(function() {
    autosize_tables();
    jqlisteners();
});
{% include "js/common.js" %}
{% include "history/modals/log.js" %}

function jqlisteners() {
    jqlisteners_history_modal_log();
};
</script>
{% endblock %}

{% block modals %}
{% include "history/modals/log.html" %}
{% endblock %}

{% block main %}
<div class="section-header" style="text-shadow: none !important;
				   height: 7%;
				   width: 100%;
				   position: relative;
				   border-bottom: 1px solid #e7e7e7;">
  <div class="title" style="float: left;
			    font-size: 30px;
			    margin: 0px;
			    padding-left: 1%;
			    position: relative;
			    text-align: left;
			    top: 50%;
			    transform: translateY(-50%);
			    width: 74%;">
    <i class="fa fa-fw fa-history" aria-hidden="true"></i>
    History
  </div>
</div>
<div class="section-content" style="position:relative;width:100%;height:93%;overflow-y:auto;padding:0% 1%;">
  <table id="table-history"
	 data-show-toggle="false"
	 data-show-export="false"
	 data-show-columns="true" data-show-multi-sort="true"
	 data-sort-name="date" data-sort-order="desc" data-pagination="true"
	 data-toggle="table" data-search="true"
	 data-show-footer="false"
	 data-page-size="30"
	 data-escape="false"
	 class="table table-hover table-striped table-compact 
		table-condensed table-autosize"
	 cellspacing="0">
    <thead>
      <tr>
	<th data-field="select" data-visible="false"
	    data-checkbox="true">
	  <i class="fa fa-fw fa-check-square"></i>
	</th>
	<th data-visible="false" data-field="status">
	  Status
	</th>
	<th data-valign="middle" data-align="center" data-field="date"
	    data-halign="center" data-sortable="true">
	  <i class="fa fa-calendar fa-fw"></i>
	  Date
	</th>
	<th data-valign="middle" data-align="center" data-field="operation"
	    data-halign="center" data-sortable="true">
	  Operation
	</th>
	<th data-valign="middle" data-align="center" data-field="master"
	    data-halign="center" data-sortable="true">
	  Master
	</th>
	<th data-valign="middle" data-align="center" data-field="view"
	    data-halign="center" data-sortable="true">
	  View
	</th>
	<th data-valign="middle" data-align="left" data-field="zone"
	    data-halign="center" data-sortable="true">
	  Zone
	</th>
	<th data-valign="middle" data-align="left" data-field="name"
	    data-halign="center" data-sortable="false">
	  Name
	</th>
	<th data-valign="middle" data-align="left" data-field="owner"
	    data-halign="center" data-sortable="true">
	  <i class="fa fa-fw fa-user"></i>
	  Owner
	</th>
	<th>
	  Note
	</th>
	<th data-valign="middle" data-align="center" data-field="actions">
	  <i class="fa fa-fw fa-cog"></i>
	</th>
      </tr>
    </thead>
    <tbody>  
      {% for p in ctx.published %}
      <tr id="{{ p.id }}">
	<td></td>
	<td></td>
	<td>{{ p.published_datetime }}</td>
	<td>{{ p.action }}</td>
	<td></td>
	<td></td>
	<td>{{ p.zone }}</td>
	<td>{{ p.name }}</td>
	<td>{% if p.user.displayname %} {{ p.user.displayname }} {% else %} {{ p.user.name }} {% endif %}</td>
	<td>{{ p.note }}</td>
	<td>
	  <a class="history-log" href="#" data-log="{{ p.out }}">
	    <i class="fa fa-fw fa-file"></i>
	  </a>
	</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
